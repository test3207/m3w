# M3W Production Deployment Environment Variables (Custom Reverse Proxy)

# ==============================================
# Frontend Configuration
# ==============================================

# API base URL (relative path for host reverse proxy)
API_BASE_URL=/api

# ==============================================
# Backend Configuration
# ==============================================

# Database (⚠️ Consider using managed database service)
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/m3w?schema=public

# MinIO (⚠️ Consider using AWS S3 or managed MinIO)
MINIO_ENDPOINT=minio
MINIO_PORT=9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_USE_SSL=false
MINIO_BUCKET_NAME=m3w-music

# JWT Authentication (⚠️ MUST CHANGE IN PRODUCTION!)
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=CHANGE-THIS-TO-A-SECURE-RANDOM-STRING-IN-PRODUCTION
JWT_ACCESS_EXPIRY=6h
JWT_REFRESH_EXPIRY=90d

# GitHub OAuth (⚠️ Configure with your domain)
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_CALLBACK_URL=https://music.example.com/api/auth/callback

# Server Configuration (⚠️ Update with your domain)
PORT=4000
HOST=0.0.0.0
API_BASE_URL=https://music.example.com
CORS_ORIGIN=https://music.example.com

# Node Environment
NODE_ENV=production

# ==============================================
# Multi-Region Configuration (Optional)
# ==============================================

# Region identifier for this backend instance
# - "jp" (Japan), "sea" (Southeast Asia), "usw" (US West), etc.
# - "default" for single-region / AIO deployment
HOME_REGION=default

# Cookie domain for auth cookies (wildcard for multi-region)
# - Multi-region: ".m3w.example.com" (note the leading dot)
# - Single-region: leave empty (cookie bound to request domain)
#
# +-----------------------------------------------------------------+
# |  SECURITY WARNING: Wildcard cookie domains                      |
# +-----------------------------------------------------------------+
# |  Wildcard cookies (e.g., ".example.com") are sent to ALL        |
# |  subdomains including:                                          |
# |  - Your backend servers (intended)                              |
# |  - Any other subdomain you control                              |
# |  - Any subdomain an attacker might hijack                       |
# |                                                                 |
# |  Only use wildcard domains when:                                |
# |  1. You control ALL subdomains under that domain                |
# |  2. All subdomains are served over HTTPS                        |
# |  3. You understand the session hijacking risk                   |
# +-----------------------------------------------------------------+
COOKIE_DOMAIN=

# Redis for cross-region user routing (optional)
# - Required for multi-region duplicate prevention
# - Not needed for single-region deployment
# REDIS_URL=redis://redis:6379

# ==============================================
# Database Service (PostgreSQL)
# ==============================================
# ⚠️ Use strong password in production!
POSTGRES_USER=postgres
POSTGRES_PASSWORD=CHANGE-THIS-TO-A-SECURE-PASSWORD
POSTGRES_DB=m3w

# ==============================================
# Storage Service (MinIO)
# ==============================================
# ⚠️ Use strong credentials in production!
MINIO_ROOT_USER=CHANGE-THIS-TO-A-SECURE-USERNAME
MINIO_ROOT_PASSWORD=CHANGE-THIS-TO-A-SECURE-PASSWORD
